id: unauth-vnc-server-detect

info:
  name: Unauthenticated VNC  Server - Detect
  author: pussycat0x
  severity: critical
  description: |
    The remote host had a VNC server that permitted access without requiring authentication.
  metadata:
    verified: true
    shodan-query: product:"vnc"
  tags: js,network,vnc,unauth,misconfig,vuln

javascript:
  - pre-condition: |
      isPortOpen(Host,Port);
    code: |
      var vnc = require('nuclei/vnc');
      var client = new vnc.VNCClient();
      var resp = client.Connect(Host, Port, " ");
      resp;

    args:
      Host: "{{Host}}"
      Port: 5900

    matchers:
      - type: dsl
        dsl:
          - "success == true"
          - "response == true"
        condition: and
# digest: 4b0a00483046022100fbfa7db92ec5cdb00b95f197475f035ee99025128088408d0882b3696dc800fe0221009b02d1586ead773b107cc0bf16562346df46956a7e323ef3d2caa1e5718c63da:922c64590222798bb761d5b6d8e72950