id: extract-urls

info:
  name: Extract URLs from HTML attributes
  author: dwisiswant0
  severity: info
  tags: headless,extractor,discovery

headless:
  - steps:
      - args:
          url: "{{BaseURL}}"
        action: navigate

      - action: waitload

      - action: script
        name: extract
        args:
          code: |
            () => {
             return '\n' + [...new Set(Array.from(document.querySelectorAll('[src], [href], [url], [action]')).map(i => i.src || i.href || i.url || i.action))].join('\r\n') + '\n'
            }

    extractors:
      - type: kval
        part: extract
        kval:
          - extract
# digest: 4a0a00473045022100a997e3b9b3b46328a38e39692483a1d44866fd82b0fab14f0fffd787291de65d02204c4b117be0798e24add289738decbe75c0572ddb52b4ba4502e3e8ca51fb3475:922c64590222798bb761d5b6d8e72950