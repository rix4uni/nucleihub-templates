id: apache-mod-cluster-exposure

info:
  name: Apache `mod_proxy_cluster` Cluster Manager Interface - Exposure
  author: oleveloper
  severity: info
  description: |
    The Apache mod_proxy_cluster management interface provides administrative control and visibility into the load balancerâ€™s nodes and contexts.
  reference:
    - https://httpd.apache.org/docs/2.4/mod/mod_proxy_cluster.html
  metadata:
    verified: true
    max-request: 3
  tags: apache,mod_proxy,cluster,exposure,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/mcm"
      - "{{BaseURL}}/cluster-manager"
      - "{{BaseURL}}/mod_cluster_manager"

    host-redirects: true
    max-redirects: 2

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains_any(body, "Mod_cluster Status","Protocol supported","mod_proxy_cluster")'
          - 'contains(header, "text/html")'
          - 'status_code == 200'
        condition: and
# digest: 4b0a004830460221008ca010367ea0b4760d65d151b2a11dac5a289f0e72cac1d8e0f15cdb5e150278022100f9d66247559279d772655c72a3b700fd08aeed2164257a406116cf0c881a7247:922c64590222798bb761d5b6d8e72950