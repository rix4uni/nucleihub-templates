id: nh-c2

info:
  name: NH C2 Server - Detect
  author: pussycat0
  severity: info
  reference:
    - https://twitter.com/MichalKoczwara/status/1616179246216396806
  metadata:
    verified: "true"
    max-request: 1
    censys-query: 10baf5fcdde4563d3e145a1f553ae433fb1c3572
  tags: tech,nh,c2,panel,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "status_code == 301 && status_code == 302"
          - "(\"03609e8e4a0a0ef888327d64ae2dc8950664219e\" == sha1(body))"
        condition: and
# digest: 4b0a00483046022100a20c46b53d0edb57cb0ba284a1830dd66f552a46b01e9de66bd87c6f3e3531d6022100b4e6b964fbaeee62c53249434fbfa5fb5db288c782ac2e63f2d739a409059029:922c64590222798bb761d5b6d8e72950