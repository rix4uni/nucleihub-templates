id: jolokia-heap-info-disclosure

info:
  name: Jolokia Java Heap Information Disclosure
  author: milo2012
  severity: info
  metadata:
    max-request: 1
  tags: jolokia,disclosure,java,vuln

http:
  - raw:
      - |
        POST /jolokia/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded


        {
           "type":"EXEC",
           "mbean":"com.sun.management:type=HotSpotDiagnostic",
           "operation":"dumpHeap",
           "arguments":[
              "/tmp1234/test1.hprof",
              0
           ]
        }

    matchers:
      - type: word
        part: body
        words:
          - 'stacktrace":"java.io.IOException: No such file or directory'
# digest: 4b0a00483046022100f5285161e2fcd392a069daf21cc46d88d10c39b81a8b487d7c0b9ec0a49efb9c022100dc74437c2c4c5c9d16aef6e4ef9f1f74745cbd4598569fb93dfee6ddd61a5667:922c64590222798bb761d5b6d8e72950