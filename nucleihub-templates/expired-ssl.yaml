id: expired-ssl

info:
  name: Expired SSL Certificate
  author: pdteam
  severity: low
  description: |
    After an SSL certificate expires, you will no longer be able to communicate over a secure, encrypted HTTPS connection.
  remediation: |
    Purchase or generate a new SSL/TLS certificate to replace the existing one.
  reference:
    - https://www.acunetix.com/vulnerabilities/web/tls-ssl-certificate-about-to-expire/
  metadata:
    max-request: 1
  tags: ssl,tls,vuln
ssl:
  - address: "{{Host}}:{{Port}}"
    matchers:
      - type: dsl
        dsl:
          - "expired == true"

    extractors:
      - type: kval
        kval:
          - "not_after"
# digest: 4a0a00473045022066ae45efbf1bb3b7a6b523ffee2a38599594d8331ebaef499401b658b33ccfee022100bb8949035aea46c01b0a33f271b33faf17fa55b1a82dfb94706f402f98819c29:922c64590222798bb761d5b6d8e72950