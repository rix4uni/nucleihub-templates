id: petya-malware-variant-1

info:
  name: Petya Malware (Variant 1) - Detect
  author: daffainfo
  severity: info
  reference:
    - https://github.com/airbnb/binaryalert/blob/master/rules/public/ransomware/windows/ransomware_windows_petya_variant_1.yara
  tags: malware,file,petya
file:
  - extensions:
      - all
    matchers:
      - type: word
        part: raw
        words:
          - "Ooops, your important files are encrypted."
          - "Send your Bitcoin wallet ID and personal installation key to e-mail"
          - "wowsmith123456@posteo.net. Your personal installation key:"
          - "Send $300 worth of Bitcoin to following address:"
          - "have been encrypted.  Perhaps you are busy looking for a way to recover your"
          - "need to do is submit the payment and purchase the decryption key."
        condition: or
# digest: 4b0a00483046022100c3089921515721f3230465ac66729068e294d4be298ce7ed254ebb7d431a47aa02210090c48013bfc8992308d9d65ab85a4711aecd3deea720f398158611b808e49d00:922c64590222798bb761d5b6d8e72950