id: kube-api-nodes

info:
  name: Kube API Nodes
  author: sharath,ritikchaddha
  severity: info
  description: Scans for kube nodes
  metadata:
    max-request: 1
  tags: tech,k8s,kubernetes,devops,kube,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/v1/nodes"

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - '"NodeList":'
          - '"items":'
        condition: and

      - type: word
        part: body
        words:
          - '"containerRuntimeVersion"'
          - '"kubeletVersion": "v'
        condition: and
# digest: 4a0a00473045022100cb9aa04175f26d949d6d95f454b19697264a8f4bb2706bdd87a3b69e50f8745202205cc39acb51196c83d9686d2875c2327a6fd944ec77b8302f718ad03fd233e622:922c64590222798bb761d5b6d8e72950