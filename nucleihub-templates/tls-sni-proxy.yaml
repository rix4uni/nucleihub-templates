id: tls-sni-proxy

info:
  name: TLS SNI Proxy Detection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/ssrf-vulnerabilities-caused-by-sni-proxy-misconfigurations/
    - https://www.bamsoftware.com/computers/sniproxy/
  metadata:
    max-request: 1
  tags: misconfig,ssrf,oast,tls,sni,proxy,vuln

http:
  - raw:
      - |
        @tls-sni: interactsh-url
        GET HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"
# digest: 4b0a00483046022100ab2d4f2ec9d7ab0c2488b59d3b1175f9a939946faf0a468c0e1189fcd38a0e45022100faf07ed5cee1eda723308cb3c125feee8afa42fcc14c69c846c179de2e13d81c:922c64590222798bb761d5b6d8e72950