id: vnc-service-detect

info:
  name: VNC Service Detection
  author: pussycat0x
  severity: info
  description: A Virtual Network Computing (VNC) service was detected.
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: network,vnc,service,detect,detection,tcp,discovery

tcp:
  - inputs:
      - data: "\r\n"
    host:
      - "{{Hostname}}"
    port: 5900

    matchers:
      - type: word
        words:
          - "RFB"

    extractors:
      - type: regex
        part: body
        regex:
          - "RFB ([0-9.]+)"
# digest: 490a0046304402205490fd4a33dc18274e879e875ceb9dfcd7aab19e2c5382192905fd5c34f50fd202203df265c00c77ac4beac3a52deacd71c2911e5365e9a86af04ac8f64db415eb77:922c64590222798bb761d5b6d8e72950