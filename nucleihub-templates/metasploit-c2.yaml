id: metasploit-c2

info:
  name: Metasploit C2 - Detect
  author: pussycat0x
  severity: info
  description: |
    A Metasploit Framework is a powerful tool that provides a universal interface to work with vulnerability exploit code. It has to exploit code for a wide range of vulnerabilities that impact web servers, OSes, network equipment, and everything in between. Metasploit which serves as both exploitation and C2 frameworks.
  reference: |
    https://www.socinvestigation.com/shodan-filters-to-hunt-adversaries-infrastructure-and-c2/
  metadata:
    verified: "true"
    max-request: 1
    shodan-query: ssl:"MetasploitSelfSignedCA"
  tags: c2,ssl,tls,ir,osint,malware,metasploit,discovery
ssl:
  - address: "{{Host}}:{{Port}}"
    matchers:
      - type: word
        part: issuer_cn
        words:
          - "MetasploitSelfSignedCA"

    extractors:
      - type: json
        json:
          - " .issuer_cn"
# digest: 4a0a0047304502204530eebc79201ff0f1c4bf0223a583c736e6a4e9f89ce9930c62beeeb6851729022100e3ea3b671eef673c93db34ffa2f4396a5f4b6575dd6d8dec863d5af24d7141b6:922c64590222798bb761d5b6d8e72950