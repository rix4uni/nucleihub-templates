id: sphinxsearch-config

info:
  name: Sphinx Search Config - Exposure
  author: gtrrnr
  severity: high
  description: sphinx.conf file contains SQL credentials and is publicly accessible.
  impact: |
    An attacker can use leaked credentials to gain access to database.
  reference:
    - https://github.com/manticorp/SphinxSearch/blob/master/sphinx.conf.example
  metadata:
    verified: true
    max-request: 7
  tags: sphinx,sphinxsearch,exposure,config,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/config/development.sphinx.conf"
      - "{{BaseURL}}/config/production.sphinx.conf"
      - "{{BaseURL}}/configs/sphinx.conf"
      - "{{BaseURL}}/search/configs/sphinx.conf"
      - "{{BaseURL}}/sphinx.conf"
      - "{{BaseURL}}/sphinx/sphinx.conf"
      - "{{BaseURL}}/sphinxsearch/sphinx.conf"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "sql_user"
          - "sql_pass"
          - "indexer"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022049ab1652f5acfe50b74bfa7e5dd5745681fd39ce4c2482b743dbe6e7f3f98523022100a8433ec7f79fc13fa7815654cafd91ecd83a23154c34f488716be4ae347889d4:922c64590222798bb761d5b6d8e72950