id: pinata-api-key

info:
  name: Pinata API Key - Expose
  author: 0xpugal
  severity: info
  tags: pinata,exposure,api-keys,tokens,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: false
    matchers:
      - type: word
        words:
          - "pinata_api_key"
          - "pinata_api_secret"
          - "pinataKey"
          - "pinataSecret"
          - "pinata-key"
          - "pinata_secret"
        case-insensitive: true
        condition: or

    extractors:
      - type: regex
        part: body
        regex:
          - (?i)pinata[_\-.]?(?:api[_\-.]?)?key\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata[_\-.]?(?:api[_\-.]?)?secret\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)PINATA[_\-.]?(?:API[_\-.]?)?KEY\s*=\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)PINATA[_\-.]?(?:API[_\-.]?)?SECRET\s*=\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata(?:[_\-. ]|)(?:api|Api|API|)?(?:[_\-. ]|)(?:key|Key)\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata(?:[_\-. ]|)(?:api|Api|API|)?(?:[_\-. ]|)(?:secret|Secret)\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)"?pinata[_\-.]?(?:api[_\-.]?)?key\"?\s*[:]\s*\"([A-Za-z0-9_\-]+)\"
          - (?i)"?pinata[_\-.]?(?:api[_\-.]?)?secret\"?\s*[:]\s*\"([A-Za-z0-9_\-]+)\"
          - (?i)(?:const|let|var)?\s*pinata[_\-.]?(?:api[_\-.]?)?key\s*=\s*['"]([A-Za-z0-9_\-]+)['"]
          - (?i)(?:const|let|var)?\s*pinata[_\-.]?(?:api[_\-.]?)?secret\s*=\s*['"]([A-Za-z0-9_\-]+)['"]
          - (?i)pinata[^A-Za-z0-9]{0,8}([A-Za-z0-9_\-]{16,128})
# digest: 490a00463044022003ed6806fea77008eb756b52335d33851376dd29ba37a376ba2153ac23b6d9310220185a65e14ce0df215b42ffd084ca8e4491feff11ac0a10a6ac4be38322dc076f:922c64590222798bb761d5b6d8e72950