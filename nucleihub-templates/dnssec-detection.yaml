id: dnssec-detection

info:
  name: DNSSEC Detection
  author: pdteam
  severity: info
  description: Domain Name System Security Extensions (DNSSEC) are enabled. The Delegation of Signing (DS) record provides information about a signed zone file when DNSSEC enabled.
  reference:
    - https://www.icann.org/resources/pages/dnssec-what-is-it-why-important-2019-03-05-en
    - https://www.cyberciti.biz/faq/unix-linux-test-and-validate-dnssec-using-dig-command-line/
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: dns,dnssec,discovery

dns:
  - name: "{{FQDN}}"
    type: DS
    matchers:
      - type: regex
        part: answer
        regex:
          - "IN\tDS\\t(.+)$"
# digest: 4a0a00473045022100a54ec0a1df8667466589298fb4c3a480e9b6ad844d73525b7d59ff4912a332b502201160d7cfb288d81a8a06771ab839d8b8c6635b53c9182c896904b1ea35e102c9:922c64590222798bb761d5b6d8e72950