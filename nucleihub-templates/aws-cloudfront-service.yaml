id: aws-cloudfront-service

info:
  name: AWS Cloudfront service detection
  author: jiheon-dev
  severity: info
  description: Detect websites using AWS cloudfront service
  metadata:
    max-request: 1
  tags: aws,tech,service,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: dsl
        condition: or
        dsl:
          - "contains(tolower(header), 'x-cache: hit from cloudfront')"
          - "contains(tolower(header), 'x-cache: refreshhit from cloudfront')"
          - "contains(tolower(header), 'x-cache: miss from cloudfront')"
          - "contains(tolower(header), 'x-cache: error from cloudfront')"
# digest: 4a0a0047304502207b89aef1c39f54d1eb520dd1c82185e1bc6a50c7e1b0194d12d9c7f96ac5e9240221008d4c1131c1239202e74006dc3d1293e457f0ff14449b558dc4b54d373b56fb30:922c64590222798bb761d5b6d8e72950