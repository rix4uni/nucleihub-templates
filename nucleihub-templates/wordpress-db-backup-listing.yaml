id: wordpress-db-backup-listing

info:
  name: WordPress DB Backup
  author: Suman_Kar
  severity: medium
  description: WordPress DB Backup plugin exposes db file along with directory listing.
  metadata:
    max-request: 1
  tags: wordpress,backup,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/uploads/database-backups/"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Index of /"
          - "wp-content/uploads/database-backups"
          - ".sql"
        condition: and
        part: body

      - type: status
        status:
          - 200
# digest: 490a0046304402202c6eddaf77b1727b48c39e2a24c82d28f189a25aad260c277ecd26fe7fc1523402206b6291d3718925f609afcf57b7bbd23235610bd6e1ab438c7e99700e7a6b4c5d:922c64590222798bb761d5b6d8e72950