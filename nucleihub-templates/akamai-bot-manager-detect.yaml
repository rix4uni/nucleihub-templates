id: akamai-bot-manager-detect

info:
  name: Akamai Bot Manager Protection - Detect
  author: Fazle Arefin
  severity: info
  description: |
    Checks if the website is protected by Akamai Bot Manager
  reference:
    - https://www.akamai.com/legal/manage-cookie-preferences
    - https://techdocs.akamai.com/identity-cloud/docs/hosted-login-cookies-and-local-storage-1
  metadata:
    max-request: 1
  tags: akamai,bot,security,detect,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: regex
        part: header
        regex:
          - 'Set-Cookie:\s*_abck='
          - 'Set-Cookie:\s*bm_sv='
          - 'Set-Cookie:\s*ak_bmsc='
          - 'Set-Cookie:\s*bm_sz='
          - 'Set-Cookie:\s*bm_mi='
        condition: or
# digest: 4a0a00473045022100fa7cd167779ccb7f6994ea5b4ae35737abc89e3cdc254c4e5cf0659f20ea3be70220542f8e23b08e8266faa882b179b2aeec3f9ff70942a4cf103d666888cefff326:922c64590222798bb761d5b6d8e72950