id: revoked-ssl-certificate

info:
  name: Revoked SSL Certificate - Detect
  author: pussycat0x
  severity: low
  description: |
    Certificate revocation is the act of invalidating a TLS/SSL before its scheduled expiration date. A certificate should be revoked immediately when its private key shows signs of being compromised. It should also be revoked when the domain for which it was issued is no longer operational.
  reference: |
    - https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/revoked-ssl-certificate/
    - https://www.tenable.com/plugins/nnm/5837
  metadata:
    max-request: 1
  tags: ssl,tls,revoked,vuln

ssl:
  - address: "{{Host}}:{{Port}}"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "revoked == true"

      - type: dsl
        dsl:
          - "expired == true"
        negative: true
# digest: 4a0a00473045022054fa09047c0f44606d40dcce4eee8456ece1da5acd490bd6d48c478d36b3b915022100c27594c225e0c2a04c9be5273ca60495f6ced4b01fbd3305912bc6d39487fe1f:922c64590222798bb761d5b6d8e72950