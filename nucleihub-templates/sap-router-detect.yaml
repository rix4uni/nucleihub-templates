id: sap-router-detect

info:
  name: SAProuter  - Detect
  author: pussycat0x
  severity: info
  description: |
    The SAProuter is a proxy program that controls and secures communication between SAP systems and external networks.
  metadata:
    verified: true
    shodan-query: product:"SAProuter"
  tags: network,tcp,sap,tech,discovery

tcp:
  - inputs:
      - data: "00000000"
        type: hex

    host:
      - "{{Hostname}}"
    port: 3200

    read-size: 1024

    matchers:
      - type: word
        part: raw
        words:
          - "SAProuter"
          - "network interface"
        condition: and

    extractors:
      - type: regex
        regex:
          - "SAProuter ([0-9.]+)"
# digest: 490a0046304402202bc518185442677fc8598395560987678475fc849d88822163f3bb9abf7ddd9b02201bdf78b7f2fbd20f3a8ee10a85bbc1b02d1d782aec30fd894a7e0c35ec741184:922c64590222798bb761d5b6d8e72950