id: usergate-ngfw-admin-panel

info:
  name: UserGate NGFW/UTM Admin Panel - Detect
  author: darses
  severity: info
  description: |
    Detect UserGate NGFW/UTM Admin Panel.
  metadata:
    max-request: 2
    shodan-query: "Server: UserGate-UTM/42"
    fofa-query: icon_hash="-782553370"
  tags: detect,panel,usergate,ngfw,utm,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/static/console-utm-webui/js/preinit.js"

    stop-at-first-match: true
    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, "Entensys.console")
        condition: and
# digest: 4a0a00473045022100b568189e5e40313992eb8c2909425bbaf11527185b8274e53d21fb0ee1554b9e02207efbc3f3725010f1562fd6e9c80201bbe35359e278a0884779f1160c44740829:922c64590222798bb761d5b6d8e72950