id: cap-hookexkeylogger-malware

info:
  name: CAP HookExKeylogger Malware - Detect
  author: daffainfo
  severity: info
  reference:
    - https://github.com/Yara-Rules/rules/blob/master/malware/MALW_CAP_HookExKeylogger.yar
  tags: malware,file
file:
  - extensions:
      - all

    matchers-condition: or
    matchers:
      - type: word
        part: raw
        words:
          - "SetWindowsHookEx"
          - "WH_KEYBOARD_LL"
        condition: and
        case-insensitive: true

      - type: word
        part: raw
        words:
          - "SetWindowsHookEx"
          - "WH_KEYBOARD"
        condition: and
        case-insensitive: true

      - type: word
        part: raw
        words:
          - "WH_KEYBOARD"
          - "WH_KEYBOARD_LL"
        condition: and
        case-insensitive: true
# digest: 4b0a00483046022100b937846fb4d792929d357de8f6268f51d6a7ed4ca15b8eb0de51cd089325d793022100f6747c026d7e666decc76a7d9aaf2bf916ad206842ee22e24c40450ffff9fc54:922c64590222798bb761d5b6d8e72950